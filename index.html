<!DOCTYPE html>
<html lang="pt-br">
<head>
    </head>
<body>
    <script>
        const API_BASE_URL = "/.netlify/functions/";
        // ... (resto das suas variáveis globais)

        function adicionarOpcaoMusica(musica) {
            const option = document.createElement('option');
            // A API agora envia o ID numérico, que é mais confiável.
            option.value = musica.id; 
            option.textContent = `${musica.titulo} - ${musica.artista}`;
            selectMusicas.appendChild(option);
        }

        function onSaveSuccess(response) {
            const statusSalvar = document.getElementById('status-salvar');
            if (response.status === "sucesso") {
                statusSalvar.style.color = 'green';
                statusSalvar.textContent = 'Cifra adicionada com sucesso!';
                
                // A nova música agora vem com o ID numérico correto do banco
                todasAsMusicas.push(response.novaMusica);
                localStorage.setItem('bancoDeCifrasCache_BD', JSON.stringify(todasAsMusicas));
                
                filtrarMusicas();
                
                setTimeout(() => {
                    document.getElementById('formModal').style.display = 'none';
                    document.getElementById('novaCifraForm').reset();
                    statusSalvar.innerHTML = '';
                    document.getElementById('btnSalvar').disabled = false;
                }, 2000);
            } else {
                onSaveFailure({ message: response.mensagem || 'Erro desconhecido.' });
            }
        }

        // --- O RESTO DO SEU SCRIPT ---
        // (Copie e cole o resto do seu script aqui, pois as outras funções não precisam de grandes alterações)
    </script>
</body>
</html>